SELECT 
	*,
	ROW_NUMBER() OVER(PARTITION BY cst_id ORDER BY cst_create_date DESC) AS Flag
FROM 
	Bronze.crm_cust_info;


--Check Nulls and Duplicates
SELECT 
	*
FROM 
	Bronze.crm_cust_info;

SELECT 
	cst_id,
	COUNT(*) AS Count_Flag
FROM
	Bronze.crm_cust_info
GROUP BY cst_id
HAVING COUNT(*) > 1 OR cst_id IS NULL;

--Check Spacing in Text
SELECT
	* 
FROM 
	Bronze.crm_cust_info
WHERE cst_firstname != TRIM(cst_firstname);



--Check Nulls and Duplicates
SELECT 
	*
FROM 
	Bronze.crm_prd_info;

SELECT 
	prd_id,
	COUNT(*) AS Count_Flag
FROM
	Bronze.crm_prd_info
GROUP BY prd_id
HAVING COUNT(*) > 1 OR prd_id IS NULL;



SELECT 
	sls_ord_num,
	COUNT(*) AS Count_Flag
FROM
	Bronze.crm_sales_details
GROUP BY sls_ord_num
HAVING COUNT(*) > 1 OR sls_ord_num IS NULL

SELECT
	*
FROM 
	Bronze.crm_sales_details
WHERE sls_ord_num != TRIM(sls_ord_num);

SELECT
	*
FROM 
	Bronze.crm_sales_details
WHERE sls_order_dt = 0 or sls_order_dt IS NULL or sls_order_dt <= 0;

SELECT
	*
FROM 
	Bronze.crm_sales_details
WHERE sls_order_dt < sls_ship_dt;


SELECT
	DISTINCT GEN
FROM 
	Bronze.erp_CUST_AZ12;

SELECT
	CASE
		WHEN UPPER(TRIM(GEN)) IN('M', 'MALE') THEN 'Male'
		WHEN UPPER(TRIM(GEN)) IN('F', 'FEMALE') THEN 'Female'
		ELSE 'n/a'
	END AS GEN
FROM 
	Bronze.erp_CUST_AZ12;


SELECT
	MAX(BDATE)
FROM 
	Bronze.erp_CUST_AZ12;




SELECT
	REPLACE(CID, '-', '') AS CID,
	COUNT(*)
FROM 
	Bronze.erp_LOC_A101
GROUP BY CID
HAVING COUNT(*) > 1;

SELECT
	DISTINCT CASE 
		WHEN TRIM(CNTRY) = 'DE' THEN 'Germany'
		WHEN TRIM(CNTRY) IN ('US', 'USA') THEN 'United States'
		WHEN TRIM(CNTRY) IS NULL OR TRIM(CNTRY) = '' THEN 'n/a'
		ELSE TRIM(CNTRY)
	END AS CNTRY,
CNTRY
FROM 
	Bronze.erp_LOC_A101;


SELECT
	*
FROM 
	Bronze.erp_PX_CAT_G1V2
WHERE 
	CAT != TRIM(CAT) OR SUBCAT != TRIM(SUBCAT) OR MAINTENANCE != TRIM(MAINTENANCE);


--verification on Silver Layer:

--Check Nulls and Duplicates
SELECT 
	*
FROM 
	Silver.crm_cust_info;

SELECT 
	cst_id,
	COUNT(*) AS Count_Flag
FROM
	Silver.crm_cust_info
GROUP BY cst_id
HAVING COUNT(*) > 1 OR cst_id IS NULL;


--Check Spacing in Text
SELECT
	* 
FROM 
	Silver.crm_cust_info
WHERE cst_lastname != TRIM(cst_lastname);


--Check Low Cardinality Col
SELECT
	DISTINCT cst_gndr
FROM 
	Silver.crm_cust_info;


--Check Low Cardinality Col
SELECT
	DISTINCT GEN
FROM 
	Silver.erp_CUST_AZ12;
